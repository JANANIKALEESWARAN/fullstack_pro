{"ast":null,"code":"import React,{createContext,useEffect,useMemo,useState}from'react';import{jsx as _jsx}from\"react/jsx-runtime\";export const WishlistContext=/*#__PURE__*/createContext(null);const STORAGE_PREFIX='wishlist-items-v1::';const WishlistProvider=_ref=>{let{children}=_ref;const userKey=localStorage.getItem('user-key')||'guest';const storageKey=\"\".concat(STORAGE_PREFIX).concat(userKey);const[wishlist,setWishlist]=useState(()=>{try{// 1) Current per-user storage\nconst raw=localStorage.getItem(storageKey);if(raw)return JSON.parse(raw);// 2) Legacy token-based key\nconst token=localStorage.getItem('auth-token')||'';const legacyTokenKey=token?\"\".concat(STORAGE_PREFIX).concat(token):'';if(legacyTokenKey){const legacyTokenRaw=localStorage.getItem(legacyTokenKey);if(legacyTokenRaw)return JSON.parse(legacyTokenRaw);}// 3) Legacy global key (pre-accounts)\nconst legacyGlobalKey='wishlist-items-v1';const legacyGlobalRaw=localStorage.getItem(legacyGlobalKey);if(legacyGlobalRaw)return JSON.parse(legacyGlobalRaw);// 4) Guest carry-over (optional)\nconst guestKey=\"\".concat(STORAGE_PREFIX,\"guest\");const guestRaw=localStorage.getItem(guestKey);if(guestRaw)return JSON.parse(guestRaw);return[];}catch(e){return[];}});// When the user changes (user-key changes), load that user's wishlist\nuseEffect(()=>{try{const raw=localStorage.getItem(storageKey);if(raw)setWishlist(JSON.parse(raw));}catch(_unused){setWishlist([]);}// eslint-disable-next-line react-hooks/exhaustive-deps\n},[storageKey]);const toggleWishlist=id=>{setWishlist(prev=>prev.includes(id)?prev.filter(x=>x!==id):[...prev,id]);};const clearWishlist=()=>setWishlist([]);const isWishlisted=id=>wishlist.includes(id);const count=wishlist.length;const value=useMemo(()=>({wishlist,toggleWishlist,clearWishlist,isWishlisted,count}),[wishlist]);return/*#__PURE__*/_jsx(WishlistContext.Provider,{value:value,children:children});};export default WishlistProvider;","map":{"version":3,"names":["React","createContext","useEffect","useMemo","useState","jsx","_jsx","WishlistContext","STORAGE_PREFIX","WishlistProvider","_ref","children","userKey","localStorage","getItem","storageKey","concat","wishlist","setWishlist","raw","JSON","parse","token","legacyTokenKey","legacyTokenRaw","legacyGlobalKey","legacyGlobalRaw","guestKey","guestRaw","e","_unused","toggleWishlist","id","prev","includes","filter","x","clearWishlist","isWishlisted","count","length","value","Provider"],"sources":["D:/ec/outfit/E_Commerence/frontend/src/Context/WishlistContext.jsx"],"sourcesContent":["import React, { createContext, useEffect, useMemo, useState } from 'react';\n\nexport const WishlistContext = createContext(null);\nconst STORAGE_PREFIX = 'wishlist-items-v1::';\n\nconst WishlistProvider = ({ children }) => {\n  const userKey = localStorage.getItem('user-key') || 'guest';\n  const storageKey = `${STORAGE_PREFIX}${userKey}`;\n\n  const [wishlist, setWishlist] = useState(() => {\n    try {\n      // 1) Current per-user storage\n      const raw = localStorage.getItem(storageKey);\n      if (raw) return JSON.parse(raw);\n\n      // 2) Legacy token-based key\n      const token = localStorage.getItem('auth-token') || '';\n      const legacyTokenKey = token ? `${STORAGE_PREFIX}${token}` : '';\n      if (legacyTokenKey) {\n        const legacyTokenRaw = localStorage.getItem(legacyTokenKey);\n        if (legacyTokenRaw) return JSON.parse(legacyTokenRaw);\n      }\n\n      // 3) Legacy global key (pre-accounts)\n      const legacyGlobalKey = 'wishlist-items-v1';\n      const legacyGlobalRaw = localStorage.getItem(legacyGlobalKey);\n      if (legacyGlobalRaw) return JSON.parse(legacyGlobalRaw);\n\n      // 4) Guest carry-over (optional)\n      const guestKey = `${STORAGE_PREFIX}guest`;\n      const guestRaw = localStorage.getItem(guestKey);\n      if (guestRaw) return JSON.parse(guestRaw);\n\n      return [];\n    } catch (e) {\n      return [];\n    }\n  });\n\n  // When the user changes (user-key changes), load that user's wishlist\n  useEffect(() => {\n    try {\n      const raw = localStorage.getItem(storageKey);\n      if (raw) setWishlist(JSON.parse(raw));\n    } catch {\n      setWishlist([]);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [storageKey]);\n\n  const toggleWishlist = (id) => {\n    setWishlist((prev) => (prev.includes(id) ? prev.filter((x) => x !== id) : [...prev, id]));\n  };\n\n  const clearWishlist = () => setWishlist([]);\n  const isWishlisted = (id) => wishlist.includes(id);\n  const count = wishlist.length;\n\n  const value = useMemo(\n    () => ({ wishlist, toggleWishlist, clearWishlist, isWishlisted, count }),\n    [wishlist]\n  );\n\n  return <WishlistContext.Provider value={value}>{children}</WishlistContext.Provider>;\n};\n\nexport default WishlistProvider;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}